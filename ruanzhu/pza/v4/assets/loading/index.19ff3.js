window.__require=function a(t,e,o){function n(i,c){if(!e[i]){if(!t[i]){var p=i.split("/");if(p=p[p.length-1],!t[p]){var s="function"==typeof __require&&__require;if(!c&&s)return s(p,!0);if(r)return r(p,!0);throw new Error("Cannot find module '"+i+"'")}i=p}var l=e[i]={exports:{}};t[i][0].call(l.exports,function(a){return n(t[i][1][a]||a)},l,l.exports,a,t,e,o)}return e[i].exports}for(var r="function"==typeof __require&&__require,i=0;i<o.length;i++)n(o[i]);return n}({pzaLoading:[function(a,t,e){"use strict";cc._RF.push(t,"27507cVVUpAoLFLVcGzTsNh","pzaLoading");var o,n=this&&this.__extends||(o=function(a,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,t){a.__proto__=t}||function(a,t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(a[e]=t[e])})(a,t)},function(a,t){function e(){this.constructor=a}o(a,t),a.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}),r=this&&this.__decorate||function(a,t,e,o){var n,r=arguments.length,i=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,e):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(a,t,e,o);else for(var c=a.length-1;c>=0;c--)(n=a[c])&&(i=(r<3?n(i):r>3?n(t,e,i):n(t,e))||i);return r>3&&i&&Object.defineProperty(t,e,i),i};Object.defineProperty(e,"__esModule",{value:!0}),e.registerHeadImgLoader=e.headImgExt=e.pzaLoading=void 0;var i=a("../Scripts/Achieve/pzaAchieveMgr"),c=a("../Scripts/Battle/pzaGameState"),p=a("../Scripts/Common/pzaDaySignConfig"),s=a("../Scripts/Common/pzaGameConfig"),l=a("../Scripts/Common/pzaGameManager"),d=a("../Scripts/Common/pzaGameMiniGame"),g=a("../Scripts/Common/pzaGamePartConfig"),h=a("../Scripts/Common/pzaGamePropConfig"),z=a("../Scripts/Common/pzaGameRecruitMgr"),u=a("../Scripts/Common/pzaGameZJ"),f=a("../Scripts/Common/pzaLocalData"),m=a("../Scripts/Common/pzaRankMgr"),y=a("../Scripts/Common/pzaShareGiftConfig"),v=a("../Scripts/Common/pzaSoundManager"),L=a("../Scripts/Common/pzaStatisticsMgr"),C=a("../Scripts/Common/pzaSurvivalConfig"),D=a("../Scripts/Common/pzaUIManager"),S=a("../Scripts/Common/pzaUtil"),T=a("../Scripts/Common/pzaZombieEnermyPartCfg"),M=a("../Scripts/Garden/pzaGardenMgr"),w=a("../Scripts/Load/pzaBundleObjectPool"),G=a("../Scripts/Load/pzaPreLoadManager"),R=a("../Scripts/MonthSign/pzaMonthSignMgr"),A=a("../Scripts/Shop/pzaShopConfig"),P=a("../Scripts/Task/pzaTaskMgr"),_=a("../Scripts/View/pzaWarningView"),V=a("../Scripts/utils/Byte_analytics"),B=a("../Scripts/utils/pzaChannel"),b=a("../Scripts/utils/pzaChannelMy"),E=a("../Scripts/utils/pzaResMgr"),I=a("../Scripts/utils/pzakc"),N=a("../start/pzaBundleController"),k=cc._decorator,U=k.ccclass,O=k.property,x=function(a){function t(){var t=null!==a&&a.apply(this,arguments)||this;return t.loginBtn=null,t.grassProBar=null,t.grassTag=null,t.ageView=null,t.flowerAni=[],t.ruanzhu=null,t.tip=null,t.loadPro=new Map,t.finishLoadCount=0,t.loadCom=!1,t.readDataCom=!1,t.canShowStart=!1,t}return n(t,a),t.prototype.onLoad=function(){I.default.init(),S.pzaUtil.initGameSpeed(),j(),this.grassProBar.fillRange=0,this.grassTag.x=-230,this.loadCom=!1,this.readDataCom=!1,this.loadGame(),this.channelInit(),this.ruanzhu.string=B.pzaChannel.instance().getRuanZhu()},t.prototype.onEnable=function(){this.loginBtn.on(cc.Node.EventType.TOUCH_START,this.clickStart,this)},t.prototype.onDisable=function(){this.loginBtn.off(cc.Node.EventType.TOUCH_START,this.clickStart,this)},t.prototype.loadGame=function(){var a=this;N.pzaBundleController.loadBundle(N.pzaBundleType.Game,function(t){null!=t?G.pzaPreLoadManager.MainResourceMap.forEach(function(t){w.pzaBundleObjectPool.preLoadResource(t,function(e,o){a.loadProgress(t,e/o)},function(){a.finishLoad(t)})}):console.error("\u52a0\u8f7dGame Bundle\u5f02\u5e38~")})},t.prototype.loadProgress=function(a,t){var e=this.loadPro.get(a);if(!(null!=e&&e>t)){this.loadPro.set(a,t);var o=0;this.loadPro.forEach(function(a){o+=a}),o/=G.pzaPreLoadManager.MainResourceMap.size,this.grassProBar.fillRange=o,this.grassTag.x=460*o-230,this.grassTag.y=68*(1-.4*o)-179-68,this.grassTag.angle=-360*o,this.grassTag.scale=1-.4*o,this.showFlower(460*o-230)}},t.prototype.finishLoad=function(){var a=this;if(this.finishLoadCount++,this.finishLoadCount>=G.pzaPreLoadManager.MainResourceMap.size){if(this.grassTag.active=!1,this.loadCom=!0,this.readDataCom)return void this.navigateToMain();this.scheduleOnce(function(){a.canShowStart=!0,a.tip.string="\u70b9\u51fb\u5f00\u59cb\u6e38\u620f"},2)}},t.prototype.navigateToMain=function(){(f.pzaLocalData.serverTime?f.pzaLocalData.serverTime:Date.now())>1722441601e3&&(R.default.instance().useNewData=!0),cc.director.loadScene("main",function(){D.pzaUIManager.baseShowBoardUI(G.pzaResourceUrl.HOME_SELECT_VIEW,null)}),f.pzaLocalData.data.dataVersion<1&&m.pzaRankMgr.syncOldRankData(),f.pzaLocalData.data.dataVersion!=f.pzaLocalData.data_verison&&(f.pzaLocalData.data.dataVersion=f.pzaLocalData.data_verison,f.pzaLocalData.addDirty("dataVersion")),b.pzaChannelMy.SOPReport(b.reportAct.reportLoadingCompleted)},t.prototype.clickStart=function(){this.loadCom&&this.canShowStart&&(B.pzaChannel.instance().getChannel().isReadRemoteUserData?(this.loadPlayerData(),this.initTDAnalytics(),this.initTTAnalytics()):this.readLocal())},t.prototype.showFlower=function(a){for(var t=0;t<this.flowerAni.length;t++){var e=this.flowerAni[t];e.active||e.x+20<a&&(e.active=!0,t<this.flowerAni.length-1?this.readDataCom&&v.pzaSoundManager.playAudio("loadingbar_flower"):this.readDataCom&&v.pzaSoundManager.playAudio("loadingbar_zombie"))}},t.prototype.clickShowAge=function(){this.ageView.active=!0},t.prototype.clickHideAge=function(){this.ageView.active=!1},t.prototype.channelInit=function(){var a=this;B.pzaChannel.getRemoteTime(),B.pzaChannel.isConfRemote&&(B.pzaChannel.instance().channel="noAD",f.pzaLocalData.testData()),B.pzaChannel.instance().init(function(){B.pzaChannel.instance().getChannel().isReadRemoteUserData?(a.loadPlayerData(),a.initTDAnalytics(),a.initTTAnalytics()):a.readLocal()})},t.prototype.loadPlayerData=function(){var a=this,t=B.pzaChannel.instance().getChannel();t.channelUserId?B.pzaChannel.loadFromRemote(t.channelUserId,function(e,o){if(e)return a.readLocal(),void(f.pzaLocalData.isShowSaveView=!0);var n=null;try{var r=f.pzaLocalData.readLocalData();null!=r&&""!=r&&"string"==typeof r&&(n=JSON.parse(r))}catch(i){console.error("loadFromRemote",i)}if(n&&!o)return a.readLocal(),void("wx"==t.channel?t.onLoginSuc():"tt"==t.channel?t.onLoginSuc():"my"==t.channel?t.onLoginSuc():"ks"==t.channel&&t.onLoginSuc());o||n||(f.pzaLocalData.isNewUser=1),!o||null!=n&&o.saveTime<n.saveTime?f.pzaLocalData.parseFromData(n):f.pzaLocalData.parseFromData(o),v.pzaSoundManager.playBgm(v.pzaBGMName.LOADING),TDAnalytics.login(t.channelUserId),L.pzaStatisticsMgr.setUserProp(),a.initConfig(),a.readDataCom=!0,a.loadCom&&a.navigateToMain(),"wx"==t.channel?t.onLoginSuc():"tt"==t.channel?t.onLoginSuc():"my"==t.channel?t.onLoginSuc():"ks"==t.channel&&t.onLoginSuc(),I.default.judgeMonth()}):this.showWarning("\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01",function(){"wx"==t.channel?t.wxLogin(function(){a.loadPlayerData()}):"my"==t.channel?t.myLogin(function(){a.loadPlayerData()}):"tt"==B.pzaChannel.instance().channel?t.ttLogin(function(){a.loadPlayerData()}):"ks"==B.pzaChannel.instance().channel?t.ksLogin(function(){a.loadPlayerData()}):a.readLocal()},function(){a.readLocal()})},t.prototype.initConfig=function(){E.pzaResMgr.instance().loadConf(function(){g.pzaWaveConfig.initBaseWaveConfig(E.pzaResMgr.instance().getConf("a2")),s.pzaGameConfig.initPlantConfig(E.pzaResMgr.instance().getConf("a3")),s.pzaGameConfig.initZombieConfig(E.pzaResMgr.instance().getConf("a4")),g.pzaGamePartConfig.initPartConfig(E.pzaResMgr.instance().getConf("a5"));var a=E.pzaResMgr.instance().getConf("a6");A.pzaShopConfig.initShopConfig(a),M.default.instance().init(),i.default.instance().init(E.pzaResMgr.instance().getConf("a14")),h.pzaGamePropConfig.initPropConfig(E.pzaResMgr.instance().getConf("a8")),p.pzaDaySignConfig.initPropConfig(E.pzaResMgr.instance().getConf("a13")),C.pzaSurvivalConfig.initSurvivalConfig(E.pzaResMgr.instance().getConf("a10")),y.pzaShareGiftConfig.initGiftConfig(E.pzaResMgr.instance().getConf("a15")),T.pzaZombieEnermyPartCfg.initPartConfig(E.pzaResMgr.instance().getConf("a16")),T.pzaZombieEnermyPartCfg.initPuffFloat(E.pzaResMgr.instance().getConf("a18")),R.default.instance().init(E.pzaResMgr.instance().getConf("a20")),E.pzaResMgr.instance().getConf("a17")&&(f.pzaLocalData.vaseAllTrophy=E.pzaResMgr.instance().getConf("a17").length-1),z.pzaGameRecruitMgr.instance().initRecruitTaskMap(E.pzaResMgr.instance().getConf("a26")),z.pzaGameRecruitMgr.instance().initRecruitDrawMap(E.pzaResMgr.instance().getConf("a27")),R.default.instance().resetInit(E.pzaResMgr.instance().getConf("a31")),"wx"==B.pzaChannel.instance().channel&&B.pzaChannel.instance().getChannel().getAbTest("expt_1720752823"),l.pzaGameManager.getGame(c.pzaGameMode.ZaJiao,u.pzaGameZJ),l.pzaGameManager.getGame(c.pzaGameMode.MINIGAME,d.pzaGameMiniGame),P.default.instance().init()}),f.pzaLocalData.data.crVaseTrophy.length<=0&&(f.pzaLocalData.data.creativeVaseTrophy[1]?f.pzaLocalData.data.crVaseTrophy[0]=f.pzaLocalData.data.creativeVaseTrophy[1]:f.pzaLocalData.data.crVaseTrophy[0]=0,f.pzaLocalData.data.creativeVaseTrophy[2]?f.pzaLocalData.data.crVaseTrophy[1]=f.pzaLocalData.data.creativeVaseTrophy[2]:f.pzaLocalData.data.crVaseTrophy[1]=0,f.pzaLocalData.data.creativeVaseTrophy[3]?f.pzaLocalData.data.crVaseTrophy[2]=f.pzaLocalData.data.creativeVaseTrophy[3]:f.pzaLocalData.data.crVaseTrophy[2]=0,f.pzaLocalData.addDirty("crVaseTrophy")),f.pzaLocalData.data.crTradTrophy.length<=0&&(f.pzaLocalData.data.creativeVaseTrophy[4]?f.pzaLocalData.data.crTradTrophy[0]=f.pzaLocalData.data.creativeVaseTrophy[4]:f.pzaLocalData.data.crTradTrophy[0]=0,f.pzaLocalData.data.creativeVaseTrophy[5]?f.pzaLocalData.data.crTradTrophy[1]=f.pzaLocalData.data.creativeVaseTrophy[5]:f.pzaLocalData.data.crTradTrophy[1]=0,f.pzaLocalData.data.creativeVaseTrophy[6]?f.pzaLocalData.data.crTradTrophy[2]=f.pzaLocalData.data.creativeVaseTrophy[6]:f.pzaLocalData.data.crTradTrophy[2]=0,f.pzaLocalData.addDirty("crTradTrophy")),f.pzaLocalData.data.creativeTrophyArr.length<=0&&(f.pzaLocalData.data.creativeTrophyArr[0]=[],f.pzaLocalData.data.creativeTrophyArr[1]=[],f.pzaLocalData.data.creativeTrophyArr[2]=[],f.pzaLocalData.data.creativeTrophyArr[3]=[],f.pzaLocalData.data.creativeTrophyArr[4]=[],f.pzaLocalData.data.creativeTrophyArr[5]=[],f.pzaLocalData.data.creativeTrophyArr[6]=[],f.pzaLocalData.data.creativeTrophyArr[7]=[],f.pzaLocalData.data.creativeTrophyArr[0][0]=f.pzaLocalData.data.zaJiaoTrophy[0]||0,f.pzaLocalData.data.creativeTrophyArr[1][0]=f.pzaLocalData.data.zaJiaoTrophy[1]||0,f.pzaLocalData.data.creativeTrophyArr[2][0]=f.pzaLocalData.data.crVaseTrophy[0],f.pzaLocalData.data.creativeTrophyArr[3][0]=f.pzaLocalData.data.crVaseTrophy[1],f.pzaLocalData.data.creativeTrophyArr[4][0]=f.pzaLocalData.data.crVaseTrophy[2],f.pzaLocalData.data.creativeTrophyArr[5][0]=f.pzaLocalData.data.crTradTrophy[0],f.pzaLocalData.data.creativeTrophyArr[6][0]=f.pzaLocalData.data.crTradTrophy[1],f.pzaLocalData.data.creativeTrophyArr[7][0]=f.pzaLocalData.data.crTradTrophy[2],f.pzaLocalData.addDirty("creativeTrophyArr")),f.pzaLocalData.data.saveNewGameLevel<f.pzaLocalData.data.newGameLevel&&(f.pzaLocalData.data.creativeNewGameArr=[],f.pzaLocalData.data.saveNewGameLevel=f.pzaLocalData.data.newGameLevel,f.pzaLocalData.addDirty("creativeNewGameArr","saveNewGameLevel")),f.pzaLocalData.data.passLastPart&&5==f.pzaLocalData.data.curChapter&&(f.pzaLocalData.data.curChapter=6,f.pzaLocalData.data.curPart=1,f.pzaLocalData.addDirty("curChapter","curPart"))},t.prototype.readLocal=function(){try{var a=f.pzaLocalData.readLocalData();if(null!=a&&""!=a&&"string"==typeof a){var t=JSON.parse(a);f.pzaLocalData.parseFromData(t)}this.initConfig()}catch(e){console.error(e)}v.pzaSoundManager.playBgm(v.pzaBGMName.LOADING),this.readDataCom=!0,this.loadCom&&this.navigateToMain(),I.default.judgeMonth()},t.prototype.showWarning=function(a,t,e){var o=this;w.pzaBundleObjectPool.requestInstantByUrl(G.pzaResourceUrl.WARNING_VIEW,!1,function(n,r){if(null==n&&null!=r){r.setParent(o.node);var i=r&&r.getComponent(_.pzaWarningView);i&&i.show(a,"\u786e\u5b9a","\u53d6\u6d88",t,e)}else console.error(n)})},t.prototype.initTDAnalytics=function(){TDAnalytics.init({appId:"aa59e60bdd334a1a9ac24f71150fed95",serverUrl:"https://tga-data-upload.hrgame.com.cn",autoTrack:{appShow:!0,appHide:!0},enableLog:!1})},t.prototype.initTTAnalytics=function(){var a=B.pzaChannel.instance().getChannel().channelUserId;if(a){var t=null;if("tt"==B.pzaChannel.instance().channel)t="mliZhDGXmrUa6qnYiA7jvS4gFhuKjLa5";else{if("ks"!=B.pzaChannel.instance().channel)return;t="4wgVDLvnfrtyUAlYxkjqgzhiSd8pbavR"}console.log("\u5f15\u529b init ");var e={accessToken:t,clientId:a,autoTrack:{appLaunch:!1,appShow:!1,appHide:!1},name:"gravityengine"};V.Byte_analytics.init(e),V.Byte_analytics.ge.setupAndStart(),V.Byte_analytics.ge.initialize({name:a,version:123,openid:a,enable_sync_attribution:!1}).then(function(a){console.log("\u5f15\u529b init success "+a),V.Byte_analytics.ge.registerEvent()}).catch(function(a){console.log("\u5f15\u529b init failed"+a)}),console.log("\u5f15\u529b init end")}},r([O(cc.Node)],t.prototype,"loginBtn",void 0),r([O({displayName:"\u8349\u5730\u8fdb\u5ea6\u6761",type:cc.Sprite})],t.prototype,"grassProBar",void 0),r([O({displayName:"\u8349\u579b\u6807\u8bb0",type:cc.Node})],t.prototype,"grassTag",void 0),r([O({displayName:"\u9002\u9f84\u63d0\u793a\u8282\u70b9",type:cc.Node})],t.prototype,"ageView",void 0),r([O({displayName:"\u82b1\u52a8\u753b",type:[cc.Node]})],t.prototype,"flowerAni",void 0),r([O({displayName:"\u8f6f\u8457",type:cc.Label})],t.prototype,"ruanzhu",void 0),r([O(cc.Label)],t.prototype,"tip",void 0),r([U],t)}(cc.Component);function j(){cc.assetManager.downloader.register(e.headImgExt,function(a,t,e){e(null,a)}),cc.assetManager.parser.register(e.headImgExt,F),cc.assetManager.factory.register(e.headImgExt,function(a,t,e,o){var n=null,r=null;try{(n=new cc.Texture2D)._uuid=a,n._nativeUrl=a,n._nativeAsset=t}catch(i){r=i}o&&o(r,n)})}function F(a,t,e){var o=new Image;function n(){o.removeEventListener("load",n),o.removeEventListener("error",r),e&&e(null,o)}function r(){o.removeEventListener("load",n),o.removeEventListener("error",r),e&&e(new Error(a))}return"file:"!==window.location.protocol&&(o.crossOrigin="anonymous"),o.addEventListener("load",n),o.addEventListener("error",r),o.src=a,o}e.pzaLoading=x,e.headImgExt=".head",e.registerHeadImgLoader=j,cc._RF.pop()},{"../Scripts/Achieve/pzaAchieveMgr":void 0,"../Scripts/Battle/pzaGameState":void 0,"../Scripts/Common/pzaDaySignConfig":void 0,"../Scripts/Common/pzaGameConfig":void 0,"../Scripts/Common/pzaGameManager":void 0,"../Scripts/Common/pzaGameMiniGame":void 0,"../Scripts/Common/pzaGamePartConfig":void 0,"../Scripts/Common/pzaGamePropConfig":void 0,"../Scripts/Common/pzaGameRecruitMgr":void 0,"../Scripts/Common/pzaGameZJ":void 0,"../Scripts/Common/pzaLocalData":void 0,"../Scripts/Common/pzaRankMgr":void 0,"../Scripts/Common/pzaShareGiftConfig":void 0,"../Scripts/Common/pzaSoundManager":void 0,"../Scripts/Common/pzaStatisticsMgr":void 0,"../Scripts/Common/pzaSurvivalConfig":void 0,"../Scripts/Common/pzaUIManager":void 0,"../Scripts/Common/pzaUtil":void 0,"../Scripts/Common/pzaZombieEnermyPartCfg":void 0,"../Scripts/Garden/pzaGardenMgr":void 0,"../Scripts/Load/pzaBundleObjectPool":void 0,"../Scripts/Load/pzaPreLoadManager":void 0,"../Scripts/MonthSign/pzaMonthSignMgr":void 0,"../Scripts/Shop/pzaShopConfig":void 0,"../Scripts/Task/pzaTaskMgr":void 0,"../Scripts/View/pzaWarningView":void 0,"../Scripts/utils/Byte_analytics":void 0,"../Scripts/utils/pzaChannel":void 0,"../Scripts/utils/pzaChannelMy":void 0,"../Scripts/utils/pzaResMgr":void 0,"../Scripts/utils/pzakc":void 0,"../start/pzaBundleController":void 0}]},{},["pzaLoading"]);