window.__require=function a(n,e,t){function o(r,c){if(!e[r]){if(!n[r]){var p=r.split("/");if(p=p[p.length-1],!n[p]){var l="function"==typeof __require&&__require;if(!c&&l)return l(p,!0);if(i)return i(p,!0);throw new Error("Cannot find module '"+r+"'")}r=p}var s=e[r]={exports:{}};n[r][0].call(s.exports,function(a){return o(n[r][1][a]||a)},s,s.exports,a,n,e,t)}return e[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<t.length;r++)o(t[r]);return o}({pzaLoading:[function(a,n,e){"use strict";cc._RF.push(n,"27507cVVUpAoLFLVcGzTsNh","pzaLoading");var t,o=this&&this.__extends||(t=function(a,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(a[e]=n[e])})(a,n)},function(a,n){function e(){this.constructor=a}t(a,n),a.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),i=this&&this.__decorate||function(a,n,e,t){var o,i=arguments.length,r=i<3?n:null===t?t=Object.getOwnPropertyDescriptor(n,e):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(a,n,e,t);else for(var c=a.length-1;c>=0;c--)(o=a[c])&&(r=(i<3?o(r):i>3?o(n,e,r):o(n,e))||r);return i>3&&r&&Object.defineProperty(n,e,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.registerHeadImgLoader=e.headImgExt=e.pzaLoading=void 0;var r=a("../Scripts/Achieve/pzaAchieveMgr"),c=a("../Scripts/Common/pzaCarConfig"),p=a("../Scripts/Common/pzaChallengePartConfig"),l=a("../Scripts/Common/pzaDaySignConfig"),s=a("../Scripts/Common/pzaEndlessPartConfig"),g=a("../Scripts/Common/pzaGameConfig"),h=a("../Scripts/Common/pzaGameOldPartConfig"),d=a("../Scripts/Common/pzaGamePartConfig"),z=a("../Scripts/Common/pzaGamePropConfig"),f=a("../Scripts/Common/pzaLocalData"),u=a("../Scripts/Common/pzaOperationMgr"),C=a("../Scripts/Common/pzaShareGiftConfig"),m=a("../Scripts/Common/pzaShovelConfig"),S=a("../Scripts/Common/pzaSoundManager"),v=a("../Scripts/Common/pzaStatisticsMgr"),y=a("../Scripts/Common/pzaUIManager"),L=a("../Scripts/Common/pzaUtil"),w=a("../Scripts/Common/pzaZjGameConfig"),D=a("../Scripts/Load/pzaBundleObjectPool"),M=a("../Scripts/Load/pzaPreLoadManager"),P=a("../Scripts/MonthSign/pzaMonthSignMgr"),_=a("../Scripts/Shop/pzaShopConfig"),R=a("../Scripts/Task/pzaTaskMgr"),T=a("../Scripts/View/Battle/pzaLoginView"),B=a("../Scripts/View/pzaWarningView"),I=a("../Scripts/utils/Byte_analytics"),A=a("../Scripts/utils/pzaChannel"),V=a("../Scripts/utils/pzaChannelMy"),b=a("../Scripts/utils/pzaResMgr"),G=a("../Scripts/utils/pzakc"),N=a("../start/pzaBundleController"),O=cc._decorator,E=O.ccclass,k=O.property,U=function(a){function n(){var n=null!==a&&a.apply(this,arguments)||this;return n.loginBtn=null,n.ageView=null,n.age12View=null,n.progressBar=null,n.proTag=null,n.ruanzhu=null,n.tip=null,n.pvzbg=null,n.noticeBtn=null,n.loginView=null,n.loadPro=new Map,n.finishLoadCount=0,n.loadCom=!1,n.readDataCom=!1,n.canShowStart=!1,n.navigateToMainStart=!1,n}return o(n,a),n.prototype.onLoad=function(){G.default.init(),L.pzaUtil.initGameSpeed(),j(),this.loadCom=!1,this.readDataCom=!1,this.age12View.active="hw"==A.pzaChannel.instance().channel,this.noticeBtn.active=!1,this.channelInit(),this.ruanzhu.string=A.pzaChannel.instance().getRuanZhu(),cc.tween(this.proTag).to(1,{angle:-360},{onUpdate:function(a){a.angle<=-360&&(a.angle=0)}}).repeatForever().start()},n.prototype.onEnable=function(){this.loginBtn.on(cc.Node.EventType.TOUCH_START,this.clickStart,this)},n.prototype.onDisable=function(){this.loginBtn.off(cc.Node.EventType.TOUCH_START,this.clickStart,this)},n.prototype.loadGame=function(){var a=this;N.pzaBundleController.loadBundle(N.pzaBundleType.Game,function(n){null!=n?M.pzaPreLoadManager.MainResourceMap.forEach(function(n){D.pzaBundleObjectPool.preLoadResource(n,function(e,t){a.loadProgress(n,e/t)},function(){a.finishLoad(n)})}):console.error("\u52a0\u8f7dGame Bundle\u5f02\u5e38~")})},n.prototype.loadProgress=function(a,n){if(this.loadPro){var e=this.loadPro.get(a);if(!(null!=e&&e>n)){this.loadPro.set(a,n);var t=0;this.loadPro.forEach(function(a){t+=a}),t/=M.pzaPreLoadManager.MainResourceMap.size,this.progressBar.progress=t,this.proTag.x=this.progressBar.node.width*t}}},n.prototype.finishLoad=function(){var a=this;if(this.finishLoadCount++,this.finishLoadCount>=M.pzaPreLoadManager.MainResourceMap.size){if(this.loadCom=!0,A.pzaChannel.instance().getCtrl("p19")&&A.pzaChannel.instance().showInter(),this.readDataCom)return void this.navigateToMain();this.scheduleOnce(function(){"hw"!=A.pzaChannel.instance().channel&&(a.canShowStart=!0,a.tip.string="\u70b9\u51fb\u5f00\u59cb\u6e38\u620f")},3)}},n.prototype.navigateToMain=function(){if(!this.navigateToMainStart){this.navigateToMainStart=!0;var a=0;"qq"==A.pzaChannel.instance().getChannel().channel&&(a=3e3),setTimeout(function(){f.pzaLocalData.serverTime?f.pzaLocalData.serverTime:Date.now(),console.log("cc.director.loadScene"),cc.director.loadScene("main",function(){y.pzaUIManager.baseShowBoardUI(M.pzaResourceUrl.HOME_SELECT_VIEW,null),u.pzaOperationMgr.checkBuyResult(function(){})}),f.pzaLocalData.data.dataVersion!=f.pzaLocalData.data_verison&&(f.pzaLocalData.data.dataVersion=f.pzaLocalData.data_verison,f.pzaLocalData.addDirty("dataVersion")),V.pzaChannelMy.SOPReport(V.reportAct.reportLoadingCompleted)},a)}},n.prototype.clickStart=function(){this.loadCom&&this.canShowStart&&(A.pzaChannel.instance().getChannel().isReadRemoteUserData?(this.loadPlayerData(),this.initTDAnalytics(),this.initTTAnalytics()):this.readLocal())},n.prototype.clickShowAge=function(){this.ageView.active=!0},n.prototype.clickHideAge=function(){this.ageView.active=!1,this.age12View.active=!1},n.prototype.setView=function(){},n.prototype.channelInit=function(){var a=this;A.pzaChannel.getRemoteTime(),A.pzaChannel.isConfRemote&&(A.pzaChannel.instance().channel="noAD"),f.pzaLocalData.testData(),this.channelSwitchSet(),A.pzaChannel.instance().init(function(){a.setView(),A.pzaChannel.onLoadShowPrivacy(a.node,function(){A.pzaChannel.checkArea(function(n){n?(a.loadGame(),A.pzaChannel.instance().getChannel().isReadRemoteUserData?(a.loadPlayerData(),a.initTDAnalytics(),a.initTTAnalytics()):a.readLocal()):(a.progressBar.node.active=!1,a.tip.string="\u76ee\u524d\u65e0\u6cd5\u767b\u5f55\uff0c\u975e\u5e38\u62b1\u6b49")})}.bind(a))})},n.prototype.channelSwitchSet=function(){"wx"==A.pzaChannel.instance().channel&&(f.pzaLocalData.isNoShareVideoSwap=!0,f.pzaLocalData.normalPowerCost=2,f.pzaLocalData.endLessPowerCost=5),"ks1"==A.pzaChannel.instance().getChannel().channel&&(f.pzaLocalData.normalPowerCost=5,f.pzaLocalData.endLessPowerCost=10,A.pzaChannel.cfmChannelAppId(A.pzaChannel.channelAppId.zwxcjs_ks)&&(f.pzaLocalData.maxPower=20,f.pzaLocalData.addPowerValue=5,f.pzaLocalData.isNoShareAct=!0,f.pzaLocalData.isShowMoreInterAd=!0)),"noAD"==A.pzaChannel.instance().channel&&A.pzaChannel.isConfRemote&&(f.pzaLocalData.isNoShareAct=!0,f.pzaLocalData.isNoShareVideoSwap=!0,f.pzaLocalData.isShowMoreInterAd=!0),"vivo"!=A.pzaChannel.instance().channel&&"oppo"!=A.pzaChannel.instance().channel&&"hw"!=A.pzaChannel.instance().channel&&"qq"!=A.pzaChannel.instance().channel&&"bl"!=A.pzaChannel.instance().channel||(f.pzaLocalData.isNoShareAct=!0,f.pzaLocalData.isNoShareVideoSwap=!0,f.pzaLocalData.isShowMoreInterAd=!0,"bl"==A.pzaChannel.instance().channel&&(f.pzaLocalData.normalPowerCost=5,f.pzaLocalData.endLessPowerCost=10))},n.prototype.loadPlayerData=function(){var a=this,n=A.pzaChannel.instance().getChannel();n.channelUserId?A.pzaChannel.loadFromRemote(n.channelUserId,function(e,t){if(e)return a.readLocal(),void(f.pzaLocalData.isShowSaveView=!0);var o=null;try{var i=f.pzaLocalData.readLocalData();null!=i&&""!=i&&"string"==typeof i&&(o=JSON.parse(i))}catch(r){console.error("loadFromRemote",r)}if(o&&!t)return a.readLocal(),void("wx"==n.channel?n.onLoginSuc():"tt"==n.channel?n.onLoginSuc():"my"==n.channel?n.onLoginSuc():"ks"==n.channel&&n.onLoginSuc());t||o||(f.pzaLocalData.isNewUser=1),!t||null!=o&&t.saveTime<o.saveTime?(t||(t=new f.pzaLocalData),f.pzaLocalData.isNewUser?console.log("\u68c0\u6d4b\u4e3a\u65b0\u8d26\u53f7,\u4f7f\u7528\u539f\u59cb\u6570\u636e!"):o&&o.saveId!=t.saveId?(f.pzaLocalData.parseFromData(t),console.log("\u68c0\u6d4b\u5207\u6362\u8d26\u53f7,\u4f7f\u7528\u8fdc\u7a0b\u6570\u636e!")):(f.pzaLocalData.parseFromData(o),console.log("\u4f7f\u7528\u672c\u5730\u6570\u636e!"))):(f.pzaLocalData.parseFromData(t),console.log("\u4f7f\u7528\u8fdc\u7a0b\u6570\u636e!")),S.pzaSoundManager.playBgm(S.pzaBGMName.LOADING),v.pzaStatisticsMgr.login(n.channelUserId),v.pzaStatisticsMgr.setUserProp(),a.initConfig(),a.readDataCom=!0,a.loadCom&&a.navigateToMain(),"wx"==n.channel?n.onLoginSuc():"tt"==n.channel?n.onLoginSuc():"my"==n.channel?n.onLoginSuc():"ks"==n.channel&&n.onLoginSuc(),G.default.judgeMonth()}):this.showWarning("\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01",function(){"wx"==n.channel?n.wxLogin(function(){a.loadPlayerData()}):"my"==n.channel?n.myLogin(function(){a.loadPlayerData()}):"tt"==A.pzaChannel.instance().channel?n.ttLogin(function(){a.loadPlayerData()}):"ks"==A.pzaChannel.instance().channel?n.ksLogin(function(){a.loadPlayerData()}):"vivo"==A.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):"oppo"==A.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):"hw"==A.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):"qq"==A.pzaChannel.instance().channel?n.qqLogin(function(){a.loadPlayerData()}):"bl"==A.pzaChannel.instance().channel?n.blLogin(function(){a.loadPlayerData()}):a.readLocal()},function(){a.readLocal()})},n.prototype.initConfig=function(){b.pzaResMgr.instance().loadConf(function(){d.pzaWaveConfig.initBaseWaveConfig(b.pzaResMgr.instance().getConf("a2")),g.pzaGameConfig.initPlantConfig(b.pzaResMgr.instance().getConf("a3")),g.pzaGameConfig.initZombieConfig(b.pzaResMgr.instance().getConf("a4")),w.pzaZjGameConfig.initZjPlantZombie(),d.pzaGamePartConfig.initPartConfig(b.pzaResMgr.instance().getConf("a7"));var a=b.pzaResMgr.instance().getConf("a8");_.pzaShopConfig.initShopConfig(a),r.default.instance().init(b.pzaResMgr.instance().getConf("a9")),p.pzaChallengePartConfig.initPartConfig(b.pzaResMgr.instance().getConf("a10")),s.pzaEndlessPartConfig.initPartConfig(b.pzaResMgr.instance().getConf("a11")),h.pzaGameOldPartConfig.initPartConfig(b.pzaResMgr.instance().getConf("a12")),z.pzaGamePropConfig.initPropConfig(b.pzaResMgr.instance().getConf("a16")),m.pzaShovelConfig.initShovelConfig(b.pzaResMgr.instance().getConf("a17")),c.pzaCarConfig.initCarConfig(b.pzaResMgr.instance().getConf("a18")),l.pzaDaySignConfig.initPropConfig(b.pzaResMgr.instance().getConf("a19")),P.default.instance().init(b.pzaResMgr.instance().getConf("a20")),C.pzaShareGiftConfig.initGiftConfig(b.pzaResMgr.instance().getConf("a21")),R.default.instance().init()})},n.prototype.readLocal=function(){try{var a=f.pzaLocalData.readLocalData();if(null!=a&&""!=a&&"string"==typeof a){var n=JSON.parse(a);f.pzaLocalData.parseFromData(n)}this.initConfig()}catch(e){console.error(e)}S.pzaSoundManager.playBgm(S.pzaBGMName.LOADING),this.readDataCom=!0,this.loadCom&&this.navigateToMain(),G.default.judgeMonth()},n.prototype.showWarning=function(a,n,e){var t=this;D.pzaBundleObjectPool.requestInstantByUrl(M.pzaResourceUrl.WARNING_VIEW,!1,function(o,i){if(null==o&&null!=i){i.setParent(t.node);var r=i&&i.getComponent(B.pzaWarningView);r&&r.show(a,"\u786e\u5b9a","\u53d6\u6d88",n,e)}else console.error(o)})},n.prototype.initTDAnalytics=function(){if("oppo"!=A.pzaChannel.instance().channel&&"vivo"!=A.pzaChannel.instance().channel&&"qq"!=A.pzaChannel.instance().channel){var a="https://tga-data-upload.hrgame.com.cn",n="aa59e60bdd334a1a9ac24f71150fed95";A.pzaChannel.cfmChannelAppId(A.pzaChannel.channelAppId.zwxcjs_ks)&&(a="https://ss.gamejym.com",n="05319408fbc94810a1b8f409cd3a2b1e"),console.log("tga report url ",a);var e={appId:n,serverUrl:a,autoTrack:{appShow:!0,appHide:!0},enableLog:!1};v.pzaStatisticsMgr.init(e)}},n.prototype.initTTAnalytics=function(){var a=A.pzaChannel.instance().getChannel().channelUserId;if(a){var n=null;if("tt"==A.pzaChannel.instance().channel)n="mliZhDGXmrUa6qnYiA7jvS4gFhuKjLa5";else{if("ks"!=A.pzaChannel.instance().channel)return;n="4wgVDLvnfrtyUAlYxkjqgzhiSd8pbavR",A.pzaChannel.cfmChannelAppId(A.pzaChannel.channelAppId.zwxcjs_ks)&&(n="wyr7ygXk4qfwMmelhRzExg0BYiQ1xLko")}console.log("\u5f15\u529b init ");var e={accessToken:n,clientId:a,autoTrack:{appLaunch:!1,appShow:!1,appHide:!1},name:"gravityengine"};I.Byte_analytics.init(e),I.Byte_analytics.ge.setupAndStart(),I.Byte_analytics.ge.initialize({name:a,version:123,openid:a,enable_sync_attribution:!1}).then(function(a){console.log("\u5f15\u529b init success "+a),I.Byte_analytics.ge.registerEvent()}).catch(function(a){console.log("\u5f15\u529b init failed"+a)}),console.log("\u5f15\u529b init end")}},n.prototype.clickNoticeBtn=function(){var a=this;D.pzaBundleObjectPool.requestInstantByUrl(M.pzaResourceUrl.NOTICE_VIEW,!1,function(n,e){null==n&&null!=e?e.setParent(a.node):console.error(n)})},i([k(cc.Node)],n.prototype,"loginBtn",void 0),i([k({displayName:"\u9002\u9f84\u63d0\u793a\u8282\u70b9",type:cc.Node})],n.prototype,"ageView",void 0),i([k({displayName:"\u9002\u9f8412+\u63d0\u793a\u8282\u70b9",type:cc.Node})],n.prototype,"age12View",void 0),i([k({displayName:"\u8fdb\u5ea6",type:cc.ProgressBar})],n.prototype,"progressBar",void 0),i([k({displayName:"\u8fdb\u5ea6\u6807\u7b7e",type:cc.Node})],n.prototype,"proTag",void 0),i([k({displayName:"\u8f6f\u8457",type:cc.Label})],n.prototype,"ruanzhu",void 0),i([k(cc.Label)],n.prototype,"tip",void 0),i([k({type:cc.Node})],n.prototype,"pvzbg",void 0),i([k({type:cc.Node})],n.prototype,"noticeBtn",void 0),i([k({type:T.pzaLoginView})],n.prototype,"loginView",void 0),i([E],n)}(cc.Component);function j(){cc.assetManager.downloader.register(e.headImgExt,function(a,n,e){e(null,a)}),cc.assetManager.parser.register(e.headImgExt,x),cc.assetManager.factory.register(e.headImgExt,function(a,n,e,t){var o=null,i=null;try{(o=new cc.Texture2D)._uuid=a,o._nativeUrl=a,o._nativeAsset=n}catch(r){i=r}t&&t(i,o)})}function x(a,n,e){var t=new Image;function o(){t.removeEventListener("load",o),t.removeEventListener("error",i),e&&e(null,t)}function i(){t.removeEventListener("load",o),t.removeEventListener("error",i),e&&e(new Error(a))}return"file:"!==window.location.protocol&&(t.crossOrigin="anonymous"),t.addEventListener("load",o),t.addEventListener("error",i),t.src=a,t}e.pzaLoading=U,e.headImgExt=".head",e.registerHeadImgLoader=j,cc._RF.pop()},{"../Scripts/Achieve/pzaAchieveMgr":void 0,"../Scripts/Common/pzaCarConfig":void 0,"../Scripts/Common/pzaChallengePartConfig":void 0,"../Scripts/Common/pzaDaySignConfig":void 0,"../Scripts/Common/pzaEndlessPartConfig":void 0,"../Scripts/Common/pzaGameConfig":void 0,"../Scripts/Common/pzaGameOldPartConfig":void 0,"../Scripts/Common/pzaGamePartConfig":void 0,"../Scripts/Common/pzaGamePropConfig":void 0,"../Scripts/Common/pzaLocalData":void 0,"../Scripts/Common/pzaOperationMgr":void 0,"../Scripts/Common/pzaShareGiftConfig":void 0,"../Scripts/Common/pzaShovelConfig":void 0,"../Scripts/Common/pzaSoundManager":void 0,"../Scripts/Common/pzaStatisticsMgr":void 0,"../Scripts/Common/pzaUIManager":void 0,"../Scripts/Common/pzaUtil":void 0,"../Scripts/Common/pzaZjGameConfig":void 0,"../Scripts/Load/pzaBundleObjectPool":void 0,"../Scripts/Load/pzaPreLoadManager":void 0,"../Scripts/MonthSign/pzaMonthSignMgr":void 0,"../Scripts/Shop/pzaShopConfig":void 0,"../Scripts/Task/pzaTaskMgr":void 0,"../Scripts/View/Battle/pzaLoginView":void 0,"../Scripts/View/pzaWarningView":void 0,"../Scripts/utils/Byte_analytics":void 0,"../Scripts/utils/pzaChannel":void 0,"../Scripts/utils/pzaChannelMy":void 0,"../Scripts/utils/pzaResMgr":void 0,"../Scripts/utils/pzakc":void 0,"../start/pzaBundleController":void 0}]},{},["pzaLoading"]);