window.__require=function a(n,e,t){function o(r,c){if(!e[r]){if(!n[r]){var p=r.split("/");if(p=p[p.length-1],!n[p]){var s="function"==typeof __require&&__require;if(!c&&s)return s(p,!0);if(i)return i(p,!0);throw new Error("Cannot find module '"+r+"'")}r=p}var l=e[r]={exports:{}};n[r][0].call(l.exports,function(a){return o(n[r][1][a]||a)},l,l.exports,a,n,e,t)}return e[r].exports}for(var i="function"==typeof __require&&__require,r=0;r<t.length;r++)o(t[r]);return o}({pzaLoading:[function(a,n,e){"use strict";cc._RF.push(n,"27507cVVUpAoLFLVcGzTsNh","pzaLoading");var t,o=this&&this.__extends||(t=function(a,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,n){a.__proto__=n}||function(a,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(a[e]=n[e])})(a,n)},function(a,n){function e(){this.constructor=a}t(a,n),a.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),i=this&&this.__decorate||function(a,n,e,t){var o,i=arguments.length,r=i<3?n:null===t?t=Object.getOwnPropertyDescriptor(n,e):t;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(a,n,e,t);else for(var c=a.length-1;c>=0;c--)(o=a[c])&&(r=(i<3?o(r):i>3?o(n,e,r):o(n,e))||r);return i>3&&r&&Object.defineProperty(n,e,r),r};Object.defineProperty(e,"__esModule",{value:!0}),e.registerHeadImgLoader=e.headImgExt=e.pzaLoading=void 0;var r=a("../Scripts/Achieve/pzaAchieveMgr"),c=a("../Scripts/Battle/pzaGameState"),p=a("../Scripts/BattlePass/pzaBattlePassMgr"),s=a("../Scripts/BattlePass/pzaBattlePassTaskMgr"),l=a("../Scripts/Common/pzaBeltEquipConfig"),g=a("../Scripts/Common/pzaDaySignConfig"),d=a("../Scripts/Common/pzaGameConfig"),f=a("../Scripts/Common/pzaGameManager"),u=a("../Scripts/Common/pzaGameMiniGame"),h=a("../Scripts/Common/pzaGamePartConfig"),z=a("../Scripts/Common/pzaGamePropConfig"),C=a("../Scripts/Common/pzaGiftConfig"),m=a("../Scripts/Common/pzaLocalData"),v=a("../Scripts/Common/pzaSoundManager"),S=a("../Scripts/Common/pzaStatisticsMgr"),y=a("../Scripts/Common/pzaSurvivalConfig"),L=a("../Scripts/Common/pzaUIManager"),M=a("../Scripts/Common/pzaUtil"),w=a("../Scripts/Common/pzaZombieEnermyPartCfg"),P=a("../Scripts/Garden/pzaGardenMgr"),D=a("../Scripts/Load/pzaBundleObjectPool"),R=a("../Scripts/Load/pzaPreLoadManager"),T=a("../Scripts/LoginRewardView/pzaLoginRewardMgr"),B=a("../Scripts/MonthSign/pzaMonthSignMgr"),_=a("../Scripts/Shop/pzaShopConfig"),G=a("../Scripts/Task/pzaTaskMgr"),I=a("../Scripts/View/Battle/pzaLoginView"),V=a("../Scripts/View/pzaWarningView"),b=a("../Scripts/newPlayerTask/pzaNewPlayTaskMgr"),E=a("../Scripts/utils/Byte_analytics"),A=a("../Scripts/utils/pzaChannel"),k=a("../Scripts/utils/pzaChannelMy"),N=a("../Scripts/utils/pzaResMgr"),U=a("../Scripts/utils/pzakc"),q=a("../start/pzaBundleController"),O=cc._decorator,x=O.ccclass,j=O.property,F=function(a){function n(){var n=null!==a&&a.apply(this,arguments)||this;return n.loginBtn=null,n.ageView=null,n.age12View=null,n.progressBar=null,n.proTag=null,n.ruanzhu=null,n.tip=null,n.pvzbg=null,n.noticeBtn=null,n.loginView=null,n.loadPro=new Map,n.finishLoadCount=0,n.loadCom=!1,n.readDataCom=!1,n.canShowStart=!1,n.navigateToMainStart=!1,n}return o(n,a),n.prototype.onLoad=function(){U.default.init(),M.pzaUtil.initGameSpeed(),W(),this.loadCom=!1,this.readDataCom=!1,this.age12View.active="hw"==A.pzaChannel.instance().channel,this.noticeBtn.active=!1,this.channelInit(),this.ruanzhu.string=A.pzaChannel.instance().getRuanZhu(),cc.tween(this.proTag).to(1,{angle:-360},{onUpdate:function(a){a.angle<=-360&&(a.angle=0)}}).repeatForever().start()},n.prototype.onEnable=function(){this.loginBtn.on(cc.Node.EventType.TOUCH_START,this.clickStart,this)},n.prototype.onDisable=function(){this.loginBtn.off(cc.Node.EventType.TOUCH_START,this.clickStart,this)},n.prototype.loadGame=function(){var a=this;q.pzaBundleController.loadBundle(q.pzaBundleType.Game,function(n){null!=n?R.pzaPreLoadManager.MainResourceMap.forEach(function(n){D.pzaBundleObjectPool.preLoadResource(n,function(e,t){a.loadProgress(n,e/t)},function(){a.finishLoad(n)})}):console.error("\u52a0\u8f7dGame Bundle\u5f02\u5e38~")})},n.prototype.loadProgress=function(a,n){if(this.loadPro){var e=this.loadPro.get(a);if(!(null!=e&&e>n)){this.loadPro.set(a,n);var t=0;this.loadPro.forEach(function(a){t+=a}),t/=R.pzaPreLoadManager.MainResourceMap.size,this.progressBar.progress=t,this.proTag.x=this.progressBar.node.width*t}}},n.prototype.finishLoad=function(){var a=this;if(this.finishLoadCount++,this.finishLoadCount>=R.pzaPreLoadManager.MainResourceMap.size){if(this.loadCom=!0,A.pzaChannel.instance().getCtrl("p19")&&A.pzaChannel.instance().showInter(),this.readDataCom)return void this.navigateToMain();this.scheduleOnce(function(){"hw"!=A.pzaChannel.instance().channel&&(a.canShowStart=!0,a.tip.string="\u70b9\u51fb\u5f00\u59cb\u6e38\u620f")},3)}},n.prototype.navigateToMain=function(){if(!this.navigateToMainStart){this.navigateToMainStart=!0;var a=0;"qq"==A.pzaChannel.instance().getChannel().channel&&(a=3e3),setTimeout(function(){m.pzaLocalData.serverTime?m.pzaLocalData.serverTime:Date.now(),console.log("cc.director.loadScene"),cc.director.loadScene("main",function(){L.pzaUIManager.baseShowBoardUI(R.pzaResourceUrl.HOME_SELECT_VIEW,null)}),m.pzaLocalData.data.dataVersion!=m.pzaLocalData.data_verison&&(m.pzaLocalData.data.dataVersion=m.pzaLocalData.data_verison,m.pzaLocalData.addDirty("dataVersion")),U.default.newPlayerJudgeDay(),k.pzaChannelMy.SOPReport(k.reportAct.reportLoadingCompleted)},a)}},n.prototype.clickStart=function(){this.loadCom&&this.canShowStart&&(A.pzaChannel.instance().getChannel().isReadRemoteUserData?(this.loadPlayerData(),this.initTDAnalytics(),this.initTTAnalytics()):this.readLocal())},n.prototype.clickShowAge=function(){this.ageView.active=!0},n.prototype.clickHideAge=function(){this.ageView.active=!1,this.age12View.active=!1},n.prototype.setView=function(){},n.prototype.channelInit=function(){var a=this;A.pzaChannel.getRemoteTime(),A.pzaChannel.isConfRemote&&(A.pzaChannel.instance().channel="noAD"),m.pzaLocalData.testData(),this.channelSwitchSet(),A.pzaChannel.instance().init(function(){a.setView(),A.pzaChannel.onLoadShowPrivacy(a.node,function(){a.loadGame(),A.pzaChannel.instance().getChannel().isReadRemoteUserData?(a.loadPlayerData(),a.initTDAnalytics(),a.initTTAnalytics()):a.readLocal()}.bind(a))})},n.prototype.channelSwitchSet=function(){A.pzaChannel.isConfRemote&&(m.pzaLocalData.isShowGift=!0)},n.prototype.loadPlayerData=function(){var a=this,n=A.pzaChannel.instance().getChannel();n.channelUserId?A.pzaChannel.loadFromRemote(n.channelUserId,function(e,t){if(e)return a.readLocal(),void(m.pzaLocalData.isShowSaveView=!0);var o=null;try{var i=m.pzaLocalData.readLocalData();null!=i&&""!=i&&"string"==typeof i&&(o=JSON.parse(i))}catch(r){console.error("loadFromRemote",r)}if(o&&!t)return a.readLocal(),void("wx"==n.channel?n.onLoginSuc():"tt"==n.channel?n.onLoginSuc():"my"==n.channel?n.onLoginSuc():"ks"==n.channel&&n.onLoginSuc());t||o||(m.pzaLocalData.isNewUser=1),!t||null!=o&&t.saveTime<o.saveTime?(t||(t=new m.pzaLocalData),m.pzaLocalData.isNewUser?console.log("\u68c0\u6d4b\u4e3a\u65b0\u8d26\u53f7,\u4f7f\u7528\u539f\u59cb\u6570\u636e!"):o&&o.saveId!=t.saveId?(m.pzaLocalData.parseFromData(t),console.log("\u68c0\u6d4b\u5207\u6362\u8d26\u53f7,\u4f7f\u7528\u8fdc\u7a0b\u6570\u636e!")):(m.pzaLocalData.parseFromData(o),console.log("\u4f7f\u7528\u672c\u5730\u6570\u636e!"))):(m.pzaLocalData.parseFromData(t),console.log("\u4f7f\u7528\u8fdc\u7a0b\u6570\u636e!")),v.pzaSoundManager.playBgm(v.pzaBGMName.LOADING),S.pzaStatisticsMgr.login(n.channelUserId),S.pzaStatisticsMgr.setUserProp(),a.initConfig(),a.readDataCom=!0,a.loadCom&&a.navigateToMain(),"wx"==n.channel?n.onLoginSuc():"tt"==n.channel?n.onLoginSuc():"my"==n.channel?n.onLoginSuc():"ks"==n.channel&&n.onLoginSuc(),U.default.judgeMonth()}):this.showWarning("\u767b\u5f55\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55\uff01",function(){"wx"==n.channel?n.wxLogin(function(){a.loadPlayerData()}):"my"==n.channel?n.myLogin(function(){a.loadPlayerData()}):"tt"==A.pzaChannel.instance().channel?n.ttLogin(function(){a.loadPlayerData()}):"ks"==A.pzaChannel.instance().channel?n.ksLogin(function(){a.loadPlayerData()}):"vivo"==A.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):"oppo"==A.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):"hw"==A.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):"qq"==A.pzaChannel.instance().channel?n.qqLogin(function(){a.loadPlayerData()}):"bl"==A.pzaChannel.instance().channel?n.blLogin(function(){a.loadPlayerData()}):"ry"==A.pzaChannel.instance().channel?n.qgLogin(function(){a.loadPlayerData()}):a.readLocal()},function(){a.readLocal()})},n.prototype.initConfig=function(){N.pzaResMgr.instance().loadConf(function(){if(h.pzaWaveConfig.initBaseWaveConfig(N.pzaResMgr.instance().getConf("a2")),d.pzaGameConfig.initPlantConfig(N.pzaResMgr.instance().getConf("a3")),d.pzaGameConfig.initZombieConfig(N.pzaResMgr.instance().getConf("a4")),h.pzaGamePartConfig.initPartConfig(N.pzaResMgr.instance().getConf("a5")),_.pzaShopConfig.initShopConfig(N.pzaResMgr.instance().getConf("a6")),z.pzaGamePropConfig.initPropConfig(N.pzaResMgr.instance().getConf("a7")),l.pzaBeltEquipConfig.initConfig(N.pzaResMgr.instance().getConf("a8")),P.default.instance().init(N.pzaResMgr.instance().getConf("a10")),r.default.instance().init(N.pzaResMgr.instance().getConf("a9")),y.pzaSurvivalConfig.initSurvivalConfig(N.pzaResMgr.instance().getConf("a15")),w.pzaZombieEnermyPartCfg.initPartConfig(N.pzaResMgr.instance().getConf("a11")),N.pzaResMgr.instance().getConf("a12")&&(m.pzaLocalData.vaseAllTrophy=N.pzaResMgr.instance().getConf("a12").length-1),w.pzaZombieEnermyPartCfg.initPuffFloat(N.pzaResMgr.instance().getConf("a13")),g.pzaDaySignConfig.initPropConfig(N.pzaResMgr.instance().getConf("a19")),B.default.instance().init(N.pzaResMgr.instance().getConf("a20")),B.default.instance().resetInit(N.pzaResMgr.instance().getConf("a20")),C.pzaGiftConfig.initPropConfig(N.pzaResMgr.instance().getConf("a22")),p.default.instance().normalRewardInit(N.pzaResMgr.instance().getConf("a23")),p.default.instance().highRewardInit(N.pzaResMgr.instance().getConf("a24")),s.default.instance().init(N.pzaResMgr.instance().getConf("a25")),b.default.instance().initNewPlayerTask(N.pzaResMgr.instance().getConf("a26")),b.default.instance().initStepRewardTask(N.pzaResMgr.instance().getConf("a27")),T.default.instance().initLoginActivityRewards(N.pzaResMgr.instance().getConf("a28")),"wx"==A.pzaChannel.instance().channel){var a=A.pzaChannel.instance().getChannel();a.getAbTest("expt_1720752823"),a.getPowerGiftAbTest("expt_1723794382")}f.pzaGameManager.getGame(c.pzaGameMode.MINIGAME,u.pzaGameMiniGame),G.default.instance().init()})},n.prototype.readLocal=function(){try{var a=m.pzaLocalData.readLocalData();if(null!=a&&""!=a&&"string"==typeof a){var n=JSON.parse(a);m.pzaLocalData.parseFromData(n)}this.initConfig()}catch(e){console.error(e)}v.pzaSoundManager.playBgm(v.pzaBGMName.LOADING),this.readDataCom=!0,this.loadCom&&this.navigateToMain(),U.default.judgeMonth()},n.prototype.showWarning=function(a,n,e){var t=this;D.pzaBundleObjectPool.requestInstantByUrl(R.pzaResourceUrl.WARNING_VIEW,!1,function(o,i){if(null==o&&null!=i){i.setParent(t.node);var r=i&&i.getComponent(V.pzaWarningView);r&&r.show(a,"\u786e\u5b9a","\u53d6\u6d88",n,e)}else console.error(o)})},n.prototype.initTDAnalytics=function(){if("oppo"!=A.pzaChannel.instance().channel&&"vivo"!=A.pzaChannel.instance().channel&&"qq"!=A.pzaChannel.instance().channel){var a="https://tga-data-upload.hrgame.com.cn";console.log("tga report url ",a);var n={appId:"aa59e60bdd334a1a9ac24f71150fed95",serverUrl:a,autoTrack:{appShow:!0,appHide:!0},enableLog:!1};S.pzaStatisticsMgr.init(n)}},n.prototype.initTTAnalytics=function(){var a=A.pzaChannel.instance().getChannel().channelUserId;if(a){var n=null;if("tt"==A.pzaChannel.instance().channel)n="mliZhDGXmrUa6qnYiA7jvS4gFhuKjLa5";else{if("ks"!=A.pzaChannel.instance().channel)return;n="4wgVDLvnfrtyUAlYxkjqgzhiSd8pbavR"}console.log("\u5f15\u529b init ");var e={accessToken:n,clientId:a,autoTrack:{appLaunch:!1,appShow:!1,appHide:!1},name:"gravityengine"};E.Byte_analytics.init(e),E.Byte_analytics.ge.setupAndStart(),E.Byte_analytics.ge.initialize({name:a,version:123,openid:a,enable_sync_attribution:!1}).then(function(a){console.log("\u5f15\u529b init success "+a),E.Byte_analytics.ge.registerEvent()}).catch(function(a){console.log("\u5f15\u529b init failed"+a)}),console.log("\u5f15\u529b init end")}},n.prototype.clickNoticeBtn=function(){},i([j(cc.Node)],n.prototype,"loginBtn",void 0),i([j({displayName:"\u9002\u9f84\u63d0\u793a\u8282\u70b9",type:cc.Node})],n.prototype,"ageView",void 0),i([j({displayName:"\u9002\u9f8412+\u63d0\u793a\u8282\u70b9",type:cc.Node})],n.prototype,"age12View",void 0),i([j({displayName:"\u8fdb\u5ea6",type:cc.ProgressBar})],n.prototype,"progressBar",void 0),i([j({displayName:"\u8fdb\u5ea6\u6807\u7b7e",type:cc.Node})],n.prototype,"proTag",void 0),i([j({displayName:"\u8f6f\u8457",type:cc.Label})],n.prototype,"ruanzhu",void 0),i([j(cc.Label)],n.prototype,"tip",void 0),i([j({type:cc.Node})],n.prototype,"pvzbg",void 0),i([j({type:cc.Node})],n.prototype,"noticeBtn",void 0),i([j({type:I.pzaLoginView})],n.prototype,"loginView",void 0),i([x],n)}(cc.Component);function W(){cc.assetManager.downloader.register(e.headImgExt,function(a,n,e){e(null,a)}),cc.assetManager.parser.register(e.headImgExt,H),cc.assetManager.factory.register(e.headImgExt,function(a,n,e,t){var o=null,i=null;try{(o=new cc.Texture2D)._uuid=a,o._nativeUrl=a,o._nativeAsset=n}catch(r){i=r}t&&t(i,o)})}function H(a,n,e){var t=new Image;function o(){t.removeEventListener("load",o),t.removeEventListener("error",i),e&&e(null,t)}function i(){t.removeEventListener("load",o),t.removeEventListener("error",i),e&&e(new Error(a))}return"file:"!==window.location.protocol&&(t.crossOrigin="anonymous"),t.addEventListener("load",o),t.addEventListener("error",i),t.src=a,t}e.pzaLoading=F,e.headImgExt=".head",e.registerHeadImgLoader=W,cc._RF.pop()},{"../Scripts/Achieve/pzaAchieveMgr":void 0,"../Scripts/Battle/pzaGameState":void 0,"../Scripts/BattlePass/pzaBattlePassMgr":void 0,"../Scripts/BattlePass/pzaBattlePassTaskMgr":void 0,"../Scripts/Common/pzaBeltEquipConfig":void 0,"../Scripts/Common/pzaDaySignConfig":void 0,"../Scripts/Common/pzaGameConfig":void 0,"../Scripts/Common/pzaGameManager":void 0,"../Scripts/Common/pzaGameMiniGame":void 0,"../Scripts/Common/pzaGamePartConfig":void 0,"../Scripts/Common/pzaGamePropConfig":void 0,"../Scripts/Common/pzaGiftConfig":void 0,"../Scripts/Common/pzaLocalData":void 0,"../Scripts/Common/pzaSoundManager":void 0,"../Scripts/Common/pzaStatisticsMgr":void 0,"../Scripts/Common/pzaSurvivalConfig":void 0,"../Scripts/Common/pzaUIManager":void 0,"../Scripts/Common/pzaUtil":void 0,"../Scripts/Common/pzaZombieEnermyPartCfg":void 0,"../Scripts/Garden/pzaGardenMgr":void 0,"../Scripts/Load/pzaBundleObjectPool":void 0,"../Scripts/Load/pzaPreLoadManager":void 0,"../Scripts/LoginRewardView/pzaLoginRewardMgr":void 0,"../Scripts/MonthSign/pzaMonthSignMgr":void 0,"../Scripts/Shop/pzaShopConfig":void 0,"../Scripts/Task/pzaTaskMgr":void 0,"../Scripts/View/Battle/pzaLoginView":void 0,"../Scripts/View/pzaWarningView":void 0,"../Scripts/newPlayerTask/pzaNewPlayTaskMgr":void 0,"../Scripts/utils/Byte_analytics":void 0,"../Scripts/utils/pzaChannel":void 0,"../Scripts/utils/pzaChannelMy":void 0,"../Scripts/utils/pzaResMgr":void 0,"../Scripts/utils/pzakc":void 0,"../start/pzaBundleController":void 0}]},{},["pzaLoading"]);